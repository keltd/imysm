<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>i miss u</title>
  <!-- Font Pixel -->
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Silkscreen&display=swap" rel="stylesheet">
  <style>
    :root{
      --pixel-size:4px;
      --soft-pink-1:#ffd6e7;
      --soft-pink-2:#ffc2dd;
      --soft-pink-3:#ffa8ce;
      --soft-pink-4:#ff8fc0;
      --soft-pink-5:#ff76b2;
      --soft-pink-6:#ff5da4;
      --soft-purple:#d9a5e8;
      --soft-yellow:#fff0ac;
      --soft-blue:#a6e3ff;
      --soft-green:#c9ffb8;
      --text-color:#6b3a5c;
      --border-color:#ffa8ce;
      --photo-border:#ffc2dd;
      --heart-color:#ff5d8f;
    }

    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      padding:20px;
      font-family:'Silkscreen',sans-serif;
      background:linear-gradient(135deg,var(--soft-pink-1) 0%,var(--soft-purple) 100%);
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      min-height:100vh;color:var(--text-color);position:relative;overflow-x:hidden;
      background-size:200% 200%;
      animation:backgroundShift 15s ease infinite;
    }

    /* Reduce motion for users who prefer it */
    @media (prefers-reduced-motion: reduce){
      *{animation-duration:0.001ms !important; animation-iteration-count:1 !important; transition-duration:0.001ms !important}
      body{animation:none}
    }

    .header{margin-bottom:30px;text-align:center;position:relative;animation:fadeInDown 1s ease-out}
    @keyframes fadeInDown{from{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:none}}
    .title{
      font-family:'Press Start 2P',cursive;font-size:24px;color:var(--text-color);
      text-shadow:3px 3px 0 var(--soft-pink-3);
      margin-bottom:15px;display:inline-block;padding:10px 20px;background-color:rgba(255,255,255,0.5);
      border:var(--pixel-size) solid var(--border-color);box-shadow:6px 6px 0px var(--soft-pink-4);
      animation:pulse 2s infinite;
    }
    @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.05)}100%{transform:scale(1)}}

    .subtitle{
      font-size:14px;opacity:0.9;max-width:600px;line-height:1.6;background-color:rgba(255,255,255,0.4);
      padding:10px 15px;border:2px solid var(--soft-pink-3);animation:fadeIn 2s ease-out;
    }
    @keyframes fadeIn{from{opacity:0}to{opacity:0.9}}

    .container{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
      gap:25px;justify-content:center;align-items:center;max-width:1000px;width:100%;
      padding:20px;position:relative;z-index:2;animation:fadeInUp 1s ease-out;
    }
    @keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:none}}

    /* Photo box with correct 3:4 ratio */
    .photo-box{
      width:100%;height:0;padding-bottom:133.3333%; /* 4/3 = 133.3333% -> menjaga rasio 3:4 */
      background-color:var(--soft-pink-1);border:var(--pixel-size) solid var(--border-color);
      border-radius:4px;position:relative;cursor:pointer;transition:transform .25s,box-shadow .25s;
      box-shadow:6px 6px 0px var(--soft-pink-4),12px 12px 0px var(--soft-purple);
      overflow:hidden;will-change:transform,box-shadow;
    }
    .photo-box:hover{transform:translate(-4px,-4px) rotate(-1deg);box-shadow:10px 10px 0px var(--soft-pink-4),16px 16px 0px var(--soft-purple),0 0 12px rgba(255,168,206,0.55)}

    .photo-box img{
      position:absolute;inset:0;width:100%;height:100%;object-fit:cover;
      image-rendering:pixelated;border:4px solid var(--photo-border);
      filter:contrast(1.05) brightness(1.05);transition:transform .4s ease,filter .25s;
      display:block;
    }
    .photo-box:hover img{transform:scale(1.08);filter:contrast(1.1) brightness(1.1) saturate(1.2)}

    .text-box{
      grid-column:1/-1;background-color:rgba(255,255,255,0.5);border:var(--pixel-size) solid var(--border-color);
      border-radius:4px;padding:20px;font-size:14px;line-height:1.6;position:relative;
      box-shadow:6px 6px 0px rgba(0,0,0,0.05);overflow:hidden;backdrop-filter:blur(5px);
      color:var(--text-color);text-shadow:1px 1px 2px rgba(255,255,255,0.8);min-height:120px;
      animation:textBoxGlow 4s infinite alternate;will-change:box-shadow,background-color;
    }
    @keyframes textBoxGlow{from{box-shadow:6px 6px 0 rgba(0,0,0,0.05),0 0 5px rgba(255,168,206,0.5)}to{box-shadow:6px 6px 0 rgba(0,0,0,0.05),0 0 15px rgba(255,168,206,0.8)}}

    /* Pixel decorations (few, light) */
    .pixel{width:var(--pixel-size);height:var(--pixel-size);position:absolute;background-color:var(--soft-yellow);border-radius:1px;z-index:1;opacity:.95}
    .pixel-1{top:10%;left:5%}.pixel-2{top:20%;right:10%}.pixel-3{bottom:15%;left:8%}.pixel-4{bottom:25%;right:7%}
    .pixel-5{top:40%;left:12%}.pixel-6{top:60%;right:15%}.pixel-7{top:15%;left:20%}.pixel-8{bottom:30%;right:20%}
    .pixel-9{top:70%;left:25%}.pixel-10{bottom:10%;right:25%}.pixel-11{top:30%;left:85%}.pixel-12{bottom:40%;left:90%}

    /* Hearts - reduced animation complexity */
    .heart{position:absolute;z-index:0;pointer-events:none;font-size:18px;color:var(--heart-color);opacity:.8;animation:float 6s ease-in-out infinite}
    @keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-18px)}100%{transform:translateY(0)}}
    .heart-1{top:10%;left:8%}.heart-2{top:25%;right:12%}.heart-3{bottom:15%;left:10%}.heart-4{bottom:30%;right:8%}.heart-5{top:65%;left:15%}.heart-6{top:45%;right:5%}.heart-7{bottom:5%;left:20%}

    /* Modal */
    .modal{display:none;position:fixed;z-index:200;left:0;top:0;width:100%;height:100%;background:rgba(255,214,231,0.95);
      justify-content:center;align-items:center;backdrop-filter:blur(4px);flex-direction:column}
    .modal-content{max-width:90%;max-height:70%;border:var(--pixel-size) solid var(--photo-border);position:relative;
      box-shadow:0 0 0 8px var(--soft-pink-3),0 0 20px rgba(0,0,0,.2);background-color:white;overflow:hidden}
    .modal img{display:block;width:100%;height:auto;transition:transform .25s}
    .close-btn{position:absolute;top:20px;right:30px;color:var(--text-color);font-size:36px;cursor:pointer;z-index:210}

    /* Love button */
    .love-button{margin-top:20px;padding:12px 24px;background:linear-gradient(to bottom,var(--soft-pink-3),var(--soft-pink-5));
      border:var(--pixel-size) solid var(--border-color);border-radius:4px;font-family:'Press Start 2P',cursive;font-size:14px;color:white;
      cursor:pointer;box-shadow:0px 4px 0px var(--soft-pink-6);transition:transform .18s,box-shadow .18s;position:relative;overflow:hidden}
    .love-button:active{transform:translateY(2px) scale(.98);box-shadow:0px 2px 0 var(--soft-pink-6)}
    .love-button::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(to right,transparent,rgba(255,255,255,.25),transparent);transform:rotate(45deg);animation:loveButtonShine 3s infinite}
    @keyframes loveButtonShine{0%{transform:translateX(-100%) rotate(45deg)}100%{transform:translateX(100%) rotate(45deg)}}

    /* Emoji floating simplified */
    .emoji{position:fixed;font-size:22px;pointer-events:none;z-index:300;opacity:1;transition:transform 3.5s linear,opacity .8s linear}

    /* Cursor trail pool elements */
    .cursor-trail{position:fixed;width:8px;height:8px;border-radius:50%;pointer-events:none;z-index:9999;opacity:0;transform:scale(0);transition:transform .6s,opacity .6s}

    /* Sparkle (one at a time, short life) */
    .sparkle{position:fixed;width:6px;height:6px;border-radius:50%;pointer-events:none;z-index:150;opacity:0;transform:scale(0);transition:transform .9s,opacity .9s}

    /* Confetti simple */
    .confetti{position:fixed;width:8px;height:8px;pointer-events:none;z-index:500;opacity:1;transition:transform 4.5s linear,opacity .6s linear}

    .footer{margin-top:40px;text-align:center;font-size:14px;color:var(--text-color);padding:10px;opacity:.8;position:relative;z-index:2}

    .instructions{background-color:rgba(255,255,255,0.7);padding:15px;border-radius:8px;margin-bottom:20px;border:2px solid var(--soft-pink-3);max-width:800px;text-align:center}

    /* Responsive */
    @media (max-width:768px){.container{grid-template-columns:repeat(2,1fr);gap:20px}.title{font-size:18px}.modal-content{max-height:60%}.love-button{padding:10px 20px;font-size:12px}}
    @media (max-width:480px){.container{grid-template-columns:1fr;max-width:300px}.photo-box{padding-bottom:133.3333%}.text-box{font-size:12px;padding:15px}.title{font-size:16px;padding:8px 12px}.modal-content{max-height:50%}.love-button{padding:8px 16px;font-size:10px}}

    @keyframes backgroundShift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
  </style>
</head>
<body>
  <!-- Floating hearts (kept) -->
  <div class="heart heart-1">❤</div>
  <div class="heart heart-2">❤</div>
  <div class="heart heart-3">❤</div>
  <div class="heart heart-4">❤</div>
  <div class="heart heart-5">❤</div>
  <div class="heart heart-6">❤</div>
  <div class="heart heart-7">❤</div>

  <!-- Pixel decorations -->
  <div class="pixel pixel-1"></div>
  <div class="pixel pixel-2"></div>
  <div class="pixel pixel-3"></div>
  <div class="pixel pixel-4"></div>
  <div class="pixel pixel-5"></div>
  <div class="pixel pixel-6"></div>
  <div class="pixel pixel-7"></div>
  <div class="pixel pixel-8"></div>
  <div class="pixel pixel-9"></div>
  <div class="pixel pixel-10"></div>
  <div class="pixel pixel-11"></div>
  <div class="pixel pixel-12"></div>

  <div class="container">
    <!-- Foto dengan rasio 3:4 -->
    <div class="photo-box"><img src="foto1.jpg" alt="foto1" loading="lazy" decoding="async"></div>
    <div class="photo-box"><img src="foto2.jpg" alt="foto2" loading="lazy" decoding="async"></div>
    <div class="photo-box"><img src="foto3.jpg" alt="foto3" loading="lazy" decoding="async"></div>
    <div class="photo-box"><img src="foto4.jpg" alt="foto4" loading="lazy" decoding="async"></div>

    <!-- Kolom Teks -->
    <div class="text-box" id="textBox"></div>
  </div>

  <!-- Modal Foto -->
  <div class="modal" id="modal" aria-hidden="true" role="dialog" aria-label="Foto popup">
    <span class="close-btn" id="closeBtn" role="button" aria-label="tutup">&times;</span>
    <div class="modal-content">
      <img id="modalImg" src="" alt="popup">
    </div>
    <button class="love-button" id="loveButton"> ❤ </button>
  </div>

  <div class="footer"><p>made with love ❤</p></div>

  <script>
    /* --- Cached DOM --- */
    const photoBoxes = Array.from(document.querySelectorAll('.photo-box'));
    const modal = document.getElementById('modal');
    const modalImg = document.getElementById('modalImg');
    const closeBtn = document.getElementById('closeBtn');
    const loveButton = document.getElementById('loveButton');
    const textBox = document.getElementById('textBox');

    /* --- Modal behavior (click photo -> open, click outside or close or ESC -> close) --- */
    function openModalWithSrc(src){
      modalImg.src = src;
      modal.style.display = 'flex';
      modal.setAttribute('aria-hidden','false');
      // small confetti burst
      createConfetti(12);
    }
    photoBoxes.forEach(box=>{
      const img = box.querySelector('img');
      box.addEventListener('click', ()=> openModalWithSrc(img.src));
    });

    function closeModal(){
      modal.style.display = 'none';
      modal.setAttribute('aria-hidden','true');
      modalImg.src = '';
    }
    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e)=> { if(e.target === modal) closeModal(); });
    document.addEventListener('keydown', (e)=> { if(e.key === 'Escape') closeModal(); });

    /* --- Typewriter (unchanged message content) --- */
    const message = "sayangg, aku bingung harus kasi kamu apa kalo lagi sakit perutt, jangan nangis nangis yaa, yang kuattt. i lovee uu so much";
    let twIndex = 0;
    function typeWriter(){
      if(twIndex < message.length){
        const char = message.charAt(twIndex);
        const span = document.createElement('span');
        span.textContent = char;
        span.style.opacity = '0';
        span.style.animation = `charAppear 0.45s ${twIndex * 0.06}s forwards`;
        textBox.appendChild(span);
        twIndex++;
        setTimeout(typeWriter, 70); // sedikit lebih cepat untuk responsif
      }
    }
    // inject keyframes for charAppear only once
    (function addCharKeyframes(){
      const s = document.createElement('style');
      s.textContent = `@keyframes charAppear{0%{opacity:0;transform:translateY(8px)}100%{opacity:1;transform:translateY(0)}}`;
      document.head.appendChild(s);
    })();

    /* --- Cursor trail: use a small pool, throttle with rAF --- */
    const TRAIL_POOL = 10;
    const trailPool = [];
    let trailPos = 0;
    let trailLastRAF = 0;
    for(let i=0;i<TRAIL_POOL;i++){
      const d = document.createElement('div');
      d.className = 'cursor-trail';
      document.body.appendChild(d);
      trailPool.push(d);
    }
    function showTrail(x,y){
      const el = trailPool[trailPos];
      trailPos = (trailPos+1)%TRAIL_POOL;
      el.style.left = (x - 4) + 'px';
      el.style.top = (y - 4) + 'px';
      el.style.backgroundColor = `hsl(${Math.random()*60 + 330},80%,65%)`; // pinkish hues
      // trigger animation via reflow
      el.style.opacity = '1';
      el.style.transform = 'scale(1)';
      // fade out after .6s
      setTimeout(()=> { el.style.opacity = '0'; el.style.transform = 'scale(0)'; }, 600);
    }
    // throttle mousemove via rAF
    let pendingMouse = null;
    function onPointerMove(e){
      pendingMouse = {x: e.clientX, y: e.clientY};
      if(!trailLastRAF){
        trailLastRAF = requestAnimationFrame(trailRAF);
      }
    }
    function trailRAF(){
      if(pendingMouse){
        showTrail(pendingMouse.x, pendingMouse.y);
        pendingMouse = null;
        trailLastRAF = requestAnimationFrame(trailRAF);
      } else {
        trailLastRAF = 0;
      }
    }
    // use passive listener for performance
    document.addEventListener('mousemove', onPointerMove, {passive:true});

    /* --- Emoji floating: limited count, batch creation with timeouts --- */
    function createEmojiBurst(count = 12){
      const emojis = ['❤','💖','💕','💓','💗','💘','💝','💞'];
      for(let i=0;i<count;i++){
        setTimeout(()=>{
          const el = document.createElement('div');
          el.className = 'emoji';
          el.textContent = emojis[Math.floor(Math.random()*emojis.length)];
          const size = Math.random()*18 + 16;
          el.style.fontSize = size + 'px';
          el.style.left = (Math.random()* (window.innerWidth * 0.9)) + 'px';
          el.style.top = (window.innerHeight + 20) + 'px';
          document.body.appendChild(el);
          // animate using transform
          const xEnd = (Math.random()*200 - 100);
          const translateY = - (window.innerHeight + 120 + Math.random()*150);
          requestAnimationFrame(()=> {
            el.style.transform = `translate(${xEnd}px, ${translateY}px) rotate(${(Math.random()*720)-360}deg)`;
            el.style.opacity = '0';
          });
          setTimeout(()=> { el.remove(); }, 3800);
        }, i * 80);
      }
    }

    /* --- Confetti: smaller burst and cleanup --- */
    function createConfetti(count = 12){
      const max = Math.min(24, Math.max(6, count));
      for(let i=0;i<max;i++){
        const el = document.createElement('div');
        el.className = 'confetti';
        el.style.left = (Math.random()*window.innerWidth) + 'px';
        el.style.top = (-10 - Math.random()*30) + 'px';
        el.style.backgroundColor = `hsl(${Math.random()*360},80%,65%)`;
        el.style.transform = `translateY(${(Math.random()* (window.innerHeight + 200))}px) rotate(${Math.random()*720}deg)`;
        el.style.opacity = '1';
        document.body.appendChild(el);
        // animate via transition: move down
        setTimeout(()=> { el.style.transform = `translateY(${window.innerHeight + 200}px) rotate(${Math.random()*1080}deg)`; el.style.opacity = '0'; }, 30);
        setTimeout(()=> { if(el.parentNode) el.parentNode.removeChild(el); }, 4800);
      }
    }

    /* --- Sparkle: single occasional sparkle (less frequent) --- */
    const sparkleInterval = 1500; // 1.5s
    let sparkleTimer = null;
    function createSparkle(){
      const el = document.createElement('div');
      el.className = 'sparkle';
      el.style.left = (Math.random()*window.innerWidth) + 'px';
      el.style.top = (Math.random()*window.innerHeight) + 'px';
      el.style.backgroundColor = `hsl(${Math.random()*360},80%,65%)`;
      document.body.appendChild(el);
      // animate
      requestAnimationFrame(()=> {
        el.style.opacity = '1';
        el.style.transform = 'scale(1)';
      });
      setTimeout(()=> { el.style.opacity = '0'; el.style.transform = 'scale(0)'; }, 900);
      setTimeout(()=> { if(el.parentNode) el.parentNode.removeChild(el); }, 1100);
    }
    // start sparkle if not reduced motion
    if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){
      sparkleTimer = setInterval(createSparkle, sparkleInterval);
    }

    /* --- Love button click: limited emoji burst --- */
    loveButton.addEventListener('click', function(){
      createEmojiBurst(12);
      // visual feedback (retrigger CSS animation)
      this.classList.remove('active-click');
      void this.offsetWidth;
      this.classList.add('active-click');
      setTimeout(()=> this.classList.remove('active-click'), 500);
    });

    /* --- Background color shift for textBox: less frequent and only when visible --- */
    const bgColors = [
      'rgba(255, 255, 255, 0.5)',
      'rgba(255, 214, 231, 0.5)',
      'rgba(255, 194, 221, 0.5)',
      'rgba(255, 168, 206, 0.5)'
    ];
    let bgInterval = null;
    function startTextBgCycle(){
      if(window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      bgInterval = setInterval(()=> {
        if(!textBox) return;
        textBox.style.backgroundColor = bgColors[Math.floor(Math.random()*bgColors.length)];
      }, 5000);
    }

    /* --- Clean up on unload to avoid timers lingering on SPA environments --- */
    window.addEventListener('beforeunload', ()=> {
      if(sparkleTimer) clearInterval(sparkleTimer);
      if(bgInterval) clearInterval(bgInterval);
    });

    /* --- Start typewriter & initial effects after DOM ready --- */
    window.addEventListener('DOMContentLoaded', ()=> {
      setTimeout(typeWriter, 900);
      startTextBgCycle();
      // small initial confetti but limited
      createConfetti(10);
    });

    /* --- Accessibility: ensure focus stays allowed on modal close button --- */
    closeBtn.setAttribute('tabindex','0');
    closeBtn.addEventListener('keydown', (e)=> { if(e.key === 'Enter' || e.key === ' ') closeModal(); });

    /* --- Prevent heavy animations on small devices: optional extra precaution --- */
    (function limitAnimationsOnLowPerf(){
      try{
        const isMobile = /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
        if(isMobile){
          // reduce pool sizes and intervals already set; nothing major to do here
        }
      }catch(e){}
    })();
  </script>
</body>
</html>
